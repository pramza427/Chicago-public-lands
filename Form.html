<style>
.navbar {
  font-size:25px;
}
.content{
  margin:5%;
  font-size:20px;
}
</style>
<!DOCTYPE html>
<html>
<head>
  <title>IT202 Project 1</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-default">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">Project 1</a>
      </div>
      <div class="collapse navbar-collapse" id="myNavbar">
        <ul class="nav navbar-nav">
          <li id="home"><a href="index.html">Home</a></li>
          <li id="form" class="active"><a href="Form.html">Form</a></li>
          <li id="data"><a href="#">Data</a></li>
          <li id="map"><a href="#">Map</a></li>
          <li id="about"><a href="About.html">About</a></li>
        </ul>
      </div>
    </div>
  </nav>
  
  <div class="content" id="formDiv">
    <h2>Filters</h2>
    <p>Choose one or more filters to enter:</p>
    <form class="form-horizontal">
      <div class="form-group">
        <div class="col-xs-8">
          <label for="ward">Ward:</label>
          <input type="number" class="form-control" id="ward" placeholder="Enter Ward Number" name="ward">
        </div>
      </div>
      <div class="form-group">
        <div class="col-xs-8">
          <label for="zip">Zip Code:</label>
          <input type="number" class="form-control" id="zip" placeholder="Enter Zip Code" name="zip">
        </div>
      </div>
      <div class="form-group">
        <div class="col-xs-4">
          <label for="sqftLow">Square Footage From:</label>
          <input type="number" class="form-control" id="sqftLow" placeholder="Lower Bound" name="sqftLow">
        </div>
        <div class="col-xs-4">
          <label for="sqftHigh">To</label>
          <input type="number" class="form-control" id="sqftHigh" placeholder="Higher Bound" name="sqftHigh">
        </div>
        
      </div>
      <div class="form-group">
        <div class="col-xs-8">
        <label for="status">Property Status:</label>
        <select class="form-control" id="status">
          <option value="All">All</option>
          <option value="Owned by City">Owned by City</option>
          <option value="Not City Owned">Not City Owned</option>
          <option value="Sold">Sold</option>
        </select>      
        </div>
      </div>
      <button id="searchBtn" type="button" class="btn btn-defualt">Search</button>
    </form>
  </div> <!-- End FormDiv -->
  
  
  <div id="dataDiv1" class="col-md-6" style="width:40%">
    
  </div>
  <div id="dataDiv2" class="col-md-6" style="width:40%">
    
  </div>
  <!-- Invisible card Template -->
  <div id="ogCard" class="panel" style="margin-left:5%">
    <div class="panel-body">
      <h4 class="panel-title"></h4>
      <h5 class="panel-subtitle mb-2 text-muted"></h5>
      <p class="panel-text"></p>
      <h6 class="panel-text"></h6> 
    </div>
  </div>
      
 
    
  
<script>
  
  let searchBtn = document.querySelector("#searchBtn");
  searchBtn.addEventListener("click", checkFilters);
  
  function checkFilters(){
    
    document.querySelector("#dataDiv1").innerHTML = "";
    document.querySelector("#dataDiv2").innerHTML = "";
   
    document.querySelector("#formDiv").style.display = "none";
    document.getElementsByClassName("active")[0].classList.remove("active");
    document.querySelector("#data").classList.add("active");
    let file = getUrl();
    fetch (file)
      .then(x => { 
              return x.json()
            })
      .then(json => {
              let i = 0;
              let originalCard = document.querySelector("#ogCard");
              for(i = 0; i < json.length; i++){
                let copy = originalCard.cloneNode(true);
                copy.querySelector("h4").innerHTML = json[i].community_area_name;
                copy.querySelector("h5").innerHTML = json[i].pin;
                let innerText = json[i].address + "<br>" + "Chicago, IL " + json[i].zip_code;
                copy.querySelector("p").innerHTML = innerText;
                let feet = json[i].sq_ft + " Square Feet";
                copy.querySelector("h6").innerHTML = feet;
                if(i%2==0){
                  document.querySelector("#dataDiv2").appendChild(copy);
                }
                else{
                  document.querySelector("#dataDiv1").appendChild(copy);
                }
                
              }
            });
  }
  
  function getUrl(){
     
    let wardnum = document.querySelector("#ward").value;
    let zip = document.querySelector("#zip").value;
    let sqftlow = document.querySelector("#sqftLow").value;
    let sqfthigh = document.querySelector("#sqftHigh").value;
    let status = document.querySelector("#status").value;
    
    let searchString = "";
    let anyFilter = 0;
    if(wardnum != ""){
      if(anyFilter == 0){
        searchString = searchString + "?$where=";
        anyFilter = 1;
      }
      searchString = searchString + "ward=" + wardnum;
    }
    if(zip != ""){
      if(anyFilter == 0){
        searchString = searchString + "?$where=";
        anyFilter = 1;
      }
      else{
        searchString = searchString + " AND "
      }
      searchString = searchString + "zip_code='" + zip + "'";
    }
    if(sqftlow != ""){
      if(anyFilter == 0){
        searchString = searchString + "?$where=";
        anyFilter = 1;
      }
      else{
        searchString = searchString + " AND "
      }
      searchString = searchString + "sq_ft>" + sqftlow;
    }
    if(sqfthigh != ""){
      if(anyFilter == 0){
        searchString = searchString + "?$where=";
        anyFilter = 1;
      }
      else{
        searchString = searchString + " AND "
      }
      searchString = searchString + "sq_ft<" + sqfthigh;
    }
    if(status != "All"){
      if(anyFilter == 0){
        searchString = searchString + "?$where=";
        anyFilter = 1;
      }
      else{
        searchString = searchString + " AND "
      }
      searchString = searchString + "property_status='" + status + "'";
    }
    
    return "https://data.cityofchicago.org/resource/aksk-kvfp.json"+searchString;
  }
  
  
</script>
  
</body>
</html>
  
